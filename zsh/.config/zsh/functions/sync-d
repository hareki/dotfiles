#!/bin/zsh

# [S]ync-[D]otfiles
sync-d () {
  # Fail fast if no argument
  if [[ $# -eq 0 ]]; then
    echo "Usage: sync-d <dir>..." >&2
    return 1
  fi

  local target_dir="$HOME"
  local failed=0

  # Ensure target exists
  mkdir -p "$target_dir" || return 1

  # Change to repo once
  z "$STOW_REPO" || return 1

  for dir in "$@"; do
    if [[ -d "$dir" ]]; then
      stow "$dir" -t "$target_dir" || failed=1
    else
      echo "Directory '$dir' does not exist in $STOW_REPO." >&2
      failed=1
    fi
  done

  z - > /dev/null
  return $failed
}
